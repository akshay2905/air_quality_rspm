<html>
	<head>
	  <title>Air Quality with respect to Respirable Suspended Particulate Matter(RSPM) in air quality stations under NAMP - 2008</title>
	  <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
	  <script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>
	   <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
     <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
	   <script src="leaflet.ajax.min.js"></script>
	  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
	   <link rel="stylesheet" href="leaflet_awesome_markers.css">
	   <script src="leaflet_awesome_markers.js"></script>
       <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
	  <style>

	  	

      body {
    padding: 0;
    margin: 0;
}
html, body, #map {
    height: 100%;
    width: 100%
}




.info { padding: 6px 8px; font: 14px/18px Arial, Helvetica, sans-serif; background: white; background: rgba(255,255,255,0.9); box-shadow: 0 0 15px rgba(0,0,0,0.2); border-radius: 5px; } .info h4 { margin: 0 0 5px; color: #777; }
.legend { text-align: left; line-height: 18px; color: #555; } .legend i { width: 18px; height: 18px; float: left; margin-right: 8px; opacity: 0.7; }


   .modal {
}
.vertical-alignment-helper {
    display:table;
    height: 100%;
    width: 100%;
}
.vertical-align-center {
    /* To center vertically */
    display: table-cell;
    vertical-align: middle;
}
.modal-content {
   
    width:inherit;
    height:inherit;
    /* To center horizontally */
    margin: 0 auto;
    font-size: 17px;
}
.modal-dialog{
  width :85%;
}
.launch{
  position:absolute;
  margin: :10px 10px;
  padding: 10px;
  z-index: 1000000;
  bottom: 30px;


}
.btn-container{
  padding: 10px ;
  margin: 20px;
}
	  </style>	
	
	</head>
	<body>
	 <div id="map" ><div class="btn-container"><button class="btn btn-primary btn-lg launch" data-toggle="modal" data-target="#myModal">Click here to Understand Map</button></div> </div>


  <!-- Button trigger modal -->
<button class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal">Launch demo modal</button>
<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="vertical-alignment-helper">
        <div class="modal-dialog vertical-align-top">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span>

                    </button>
                     <h4 class="modal-title" id="myModalLabel"><strong>Map Visualisation </strong>- <b>Air Quality with respect ot RSPM</b></h4>

                </div>
                                <div class="modal-body">What is the map trying to represent?<br>

                  
                  => This map shows the Air quality to different areas in India. The air quality is measured with respect to <a href="https://www.google.co.in/search?q=Respirable+Suspended+Particulate+Matter&oq=Respirable+Suspended+Particulate+Matter&aqs=chrome..69i57j0j69i61j0l3.747j0j4&sourceid=chrome&es_sm=93&ie=UTF-8#q=what+is+Respirable+Suspended+Particulate+Matter" target="_blank"> RSPM </a>. High levels of RSPM have been observed to cause lung diseases. <br><br>
                  
                  =>Each area can be identified with a symbol -
                    <ul>
                    <li>Industrial Icon - Industrial Area.</li>
                    <li>Tree Icon - Sensitive Area.</li>
                    <li>Home Icon - Residential and Other Area.</li>
                    </ul><br>
                =>Markers colors represent the air quality in the area -
                    <ul>
                    <li><span style="color:black;">Black</span> - Critical Level of RSPM</li>
                    <li><span style="color:red;">Red </span>- High Level of RSPM</li>
                    <li><span style="color:orange;">Orange </span>- Moderate Level of RSPM</li>
                    <li><span style="color:blue;">Blue </span>- Low level of RSPM</li>
                </ul><br><br>


                   </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    
                </div>
            </div>
        </div>
    </div>
</div>
  <script>
	  	

	  	var maplayer = L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6IjZjNmRjNzk3ZmE2MTcwOTEwMGY0MzU3YjUzOWFmNWZhIn0.Y8bhBaUMqFiPrDRW9hieoQ', {
			maxZoom: 18,
			attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
				'<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
				'Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
			id: 'mapbox.streets'
		});
		
		



var industrial_dangerIcon = L.AwesomeMarkers.icon({
        prefix: 'fa', //font awesome rather than bootstrap
        markerColor: 'black', // see colors above
        icon: 'industry' //http://fortawesome.github.io/Font-Awesome/icons/
    });


var industrial_modIcon = L.AwesomeMarkers.icon({
        prefix: 'fa', //font awesome rather than bootstrap
        markerColor: 'orange', // see colors above
        icon: 'industry' //http://fortawesome.github.io/Font-Awesome/icons/
    });

var industrial_lowIcon = L.AwesomeMarkers.icon({
        prefix: 'fa', //font awesome rather than bootstrap
        markerColor: 'blue', // see colors above
        icon: 'industry' //http://fortawesome.github.io/Font-Awesome/icons/
    });

var industrial_highIcon = L.AwesomeMarkers.icon({
        prefix: 'fa', //font awesome rather than bootstrap
        markerColor: 'red', // see colors above
        icon: 'industry' //http://fortawesome.github.io/Font-Awesome/icons/
    });


var sensitiveIcon = L.AwesomeMarkers.icon({
        prefix: 'fa', //font awesome rather than bootstrap
        markerColor: 'black', // see colors above
        icon: 'warning' //http://fortawesome.github.io/Font-Awesome/icons/
    });

var residential_criticalIcon = L.AwesomeMarkers.icon({
        prefix: 'fa', //font awesome rather than bootstrap
        markerColor: 'black', // see colors above
        icon: 'home' //http://fortawesome.github.io/Font-Awesome/icons/
    });

var residential_highIcon = L.AwesomeMarkers.icon({
        prefix: 'fa', //font awesome rather than bootstrap
        markerColor: 'red', // see colors above
        icon: 'home' //http://fortawesome.github.io/Font-Awesome/icons/
    });

var residential_modIcon = L.AwesomeMarkers.icon({
        prefix: 'fa', //font awesome rather than bootstrap
        markerColor: 'orange', // see colors above
        icon: 'home' //http://fortawesome.github.io/Font-Awesome/icons/
    });
var residential_lowIcon = L.AwesomeMarkers.icon({
        prefix: 'fa', //font awesome rather than bootstrap
        markerColor: 'blue', // see colors above
        icon: 'home' //http://fortawesome.github.io/Font-Awesome/icons/
    });

var sensitive_criticalIcon = L.AwesomeMarkers.icon({
        prefix: 'fa', //font awesome rather than bootstrap
        markerColor: 'black', // see colors above
        icon: 'tree' //http://fortawesome.github.io/Font-Awesome/icons/
    });

var sensitive_highIcon = L.AwesomeMarkers.icon({
        prefix: 'fa', //font awesome rather than bootstrap
        markerColor: 'red', // see colors above
        icon: 'tree' //http://fortawesome.github.io/Font-Awesome/icons/
    });
var sensitive_modIcon = L.AwesomeMarkers.icon({
        prefix: 'fa', //font awesome rather than bootstrap
        markerColor: 'orange', // see colors above
        icon: 'tree' //http://fortawesome.github.io/Font-Awesome/icons/
    });

var map = L.map('map',{
    center: [20.593684, 78.962880],
    zoom: 5,
    layers: maplayer
});
        
        

        var InfoControl = L.Control.extend({

        onAdd: function (map) {
            this._div = L.DomUtil.create('div', 'info');
            this.update();
            return this._div;
        },

        update: function (props) {
            this._div.innerHTML = '<h4>Air Quality (<a href="https://www.google.co.in/search?q=Respirable+Suspended+Particulate+Matter&oq=Respirable+Suspended+Particulate+Matter&aqs=chrome..69i57j0j69i61j0l3.747j0j4&sourceid=chrome&es_sm=93&ie=UTF-8#q=what+is+Respirable+Suspended+Particulate+Matter" target="_blank"> RSPM </a>) </h4>' +  (props ?
                '<b>' + props.Location + '</b> , ' + props.City + ", "+props.State +"<br>" +"Air Quality"+ " : <b>" + props.AirQuality + "</b><br / >"+ "RSPM - Annual average (g/m3)"+ " : <b>" + props.RSPM + "</b><br / >"+ "Percentage - exceedence(24 hourly)"+ " : <b>" + props.percentage + "</b><br / >"+ "Numbers of monitoring days (n)"+ " : <b>" + props.monitoringdays + "</b><br / >"
                : 'Select a Layer using the below icon');
        },

        popUp:function(props,layer){
            var popupString = '<div class="popup" style="font-size:1.2em;">';

                popupString+= " Location"+ " : " + props.Location + ", "+ props.City+", "+props.State+"<br / ><br>";

                 popupString+= "Numbers of monitoring days (n)"+ " :<b> " + props.monitoringdays + "</b><br / >";
              
                popupString+= "RSPM - Annual average (g/m3)"+ " :<b>  " + props.RSPM + "</b><br / >";

                popupString+= "Percentage - exceedence(24 hourly)"+ " :<b> " +props.percentage + "</b><br / >";


                popupString+= "Area Type"+ " : " +props.Type + "<br / >";

                popupString+= "Air Quality"+ " : " + props.AirQuality + "<br / >";

                popupString += '</div>';
                layer.bindPopup(popupString, {
                    maxHeight: 200
                });

        }
    });
        var geojson;
        var info = new InfoControl();
        info.addTo(map);

        var baseLayers = {
            "Base Layer": maplayer,
            };

    function highlightFeature(e) {
        var layer = e.target;

        info.update(layer.feature.properties);
    }

    function onClick(e){
        var layer=e.target;
        info.popUp(layer.feature.properties,layer);
    }


        function onEachFeature(feature, layer) {
        layer.on({
            mousedown:onClick,
            mouseover: highlightFeature
            
        });
    }




var legend = L.control({position: 'bottomright'});

legend.onAdd = function (map) {

    var div = L.DomUtil.create('div', 'info legend');

            div.innerHTML +=

            "Hover over the above icon to select the layer of markers.<br><br>Marker's Color represent the Level of Air Quality. <br><span style='color:black;'><b>Black</b> </span>- Critical level of RSPM.<br ><span style='color:red;'><b>Red</b> </span>- High level of RSPM <br ><span style='color:orange;'><b>Orange</b></span> - Moderate level of RSPM. <br> <span style='color:blue;'><b>Blue</b></span> - Low level of RSPM.<br><br> The Symbols represent the type of location - Industiral ,<br>Residential and Other Areas and Sensitive."  ;

            "Click on the above icon to select the layer of markers.<br><br><b>Brief Description</b> - The map shows the clusters of <br>monitoring station which measure the air<br> quality of the their location.<br> <br>Marker's Color represent the Level of Air Quality. <br><span style='color:black;'><b>Black</b> </span>- Critically Polluted.<br ><span style='color:red;'><b>Red</b> </span>- Highly Polluted. <br ><span style='color:orange;'><b>Orange</b></span> - Moderately Polluted. <br> <span style='color:blue;'><b>Blue</b></span> - Lowly Polluted.<br><br> The Symbols represent the type of location - Industiral ,<br>Residential and Other Areas and Sensitive."  ;



    return div;
};

legend.addTo(map);

          var promise = $.getJSON("data-air_quality_rspm.json");
    promise.then(function(data) {

        


        var cities = L.geoJson(data);
        
        // Industrial and Critical
        var industrial_critical = L.geoJson(data, {
            filter: function(feature, layer) {
                return feature.properties.Type == "Industrial" && feature.properties.AirQuality =="Critical";
            },
            onEachFeature:onEachFeature,
            pointToLayer: function(feature, latlng) {
                return L.marker(latlng, {
                    icon: industrial_dangerIcon
                })
            }
        });
       
          // Industrial and High
        var industrial_high = L.geoJson(data, {
            filter: function(feature, layer) {
                return feature.properties.Type == "Industrial" && feature.properties.AirQuality =="High";
            },
            onEachFeature:onEachFeature,
            pointToLayer: function(feature, latlng) {
                return L.marker(latlng, {
                    icon: industrial_highIcon
                })
            }
        });


  		// Industrial and Moderate
        var industrial_mod = L.geoJson(data, {
            filter: function(feature, layer) {
                return feature.properties.Type == "Industrial" && feature.properties.AirQuality =="Moderate";
            },
            onEachFeature:onEachFeature,
            pointToLayer: function(feature, latlng) {
                return L.marker(latlng, {
                    icon: industrial_modIcon
                })
            }
        });

        // Industrial and Low
        var industrial_low = L.geoJson(data, {
            filter: function(feature, layer) {
                return feature.properties.Type == "Industrial" && feature.properties.AirQuality =="Low";
            },
            onEachFeature:onEachFeature,
            pointToLayer: function(feature, latlng) {
                return L.marker(latlng, {
                    icon: industrial_lowIcon
                })
            }
        });


       
        // Residential Areas and Critical
        var residential_critical = L.geoJson(data, {
            filter: function(feature, layer) {
                return feature.properties.Type != "Sensitive" && feature.properties.Type != "Industrial" && feature.properties.AirQuality == "Critical";
            },
            onEachFeature:onEachFeature,
            pointToLayer: function(feature, latlng) {
                return L.marker(latlng, {
                    icon: residential_criticalIcon
                })
            }
        });

		// Residential Areas and High
        var residential_high = L.geoJson(data, {
            filter: function(feature, layer) {
                return feature.properties.Type != "Sensitive" && feature.properties.Type != "Industrial" && feature.properties.AirQuality == "High";
            },
            onEachFeature:onEachFeature,
            pointToLayer: function(feature, latlng) {
                return L.marker(latlng, {
                    icon: residential_highIcon
                })
            }
        });


		// Residential Areas and Moderate
        var residential_mod = L.geoJson(data, {
            filter: function(feature, layer) {
                return feature.properties.Type != "Sensitive" && feature.properties.Type != "Industrial" && feature.properties.AirQuality == "Moderate";
            },
            onEachFeature:onEachFeature,
            pointToLayer: function(feature, latlng) {
                return L.marker(latlng, {
                    icon: residential_modIcon
                })
            }
        });


		// Residential Areas and Low
        var residential_low = L.geoJson(data, {
            filter: function(feature, layer) {
                return feature.properties.Type != "Sensitive" && feature.properties.Type != "Industrial" && feature.properties.AirQuality == "Low";
            },
            onEachFeature:onEachFeature,
            pointToLayer: function(feature, latlng) {
                return L.marker(latlng, {
                    icon: residential_lowIcon
                })
            }
        });

        // Sensitive and High
        var sensitive_high = L.geoJson(data, {
            filter: function(feature, layer) {
                return feature.properties.Type == "Sensitive" && feature.properties.AirQuality == "High";
            },
            onEachFeature:onEachFeature,
            pointToLayer: function(feature, latlng) {
                return L.marker(latlng, {
                    icon: sensitive_highIcon
                })
            }
        });

        // Sensitive and Critical
        var sensitive_critical = L.geoJson(data, {
            filter: function(feature, layer) {
                return feature.properties.Type == "Sensitive" && feature.properties.AirQuality == "Critical";
            },
            onEachFeature:onEachFeature,
            pointToLayer: function(feature, latlng) {
                return L.marker(latlng, {
                    icon: sensitive_criticalIcon
                })
            }
        });

        // Sensitive and Critical
        var sensitive_mod = L.geoJson(data, {
            filter: function(feature, layer) {
                return feature.properties.Type == "Sensitive" && feature.properties.AirQuality == "Moderate";
            },
            onEachFeature:onEachFeature,
            pointToLayer: function(feature, latlng) {
                return L.marker(latlng, {
                    icon: sensitive_modIcon
                })
            }
        });



        var overlayMaps = {
    "Industrial Areas - Critical": industrial_critical,
    "Industrial Areas - High": industrial_high,
    "Industrial Areas - Moderate": industrial_mod,
  	"Industrial Area - Low": industrial_low,
  	"Residential/Other Areas - Critical": residential_critical,
  	"Residential/Other Areas - High": residential_high,
  	"Residential/Other Areas - Moderate": residential_mod,
  	"Residential/Other Areas - Low": residential_low,
  	"Sensitive Area - Critical" : sensitive_critical,
  	"Sensitive Area - High" : sensitive_high,
  	"Sensitive Area - Moderate" : sensitive_mod
  	
  	
  	
    
      
};
        
        L.control.layers(baseLayers,overlayMaps).addTo(map);
    });



	  </script>
	</body>
</html>
